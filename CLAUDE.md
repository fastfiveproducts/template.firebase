# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this Firebase Data Connect project.


## Build Commands
```bash
# Check schema changes against deployed database
firebase dataconnect:sql:diff

# Regenerate Swift connector code after schema/query/mutation changes
firebase dataconnect:sdk:generate
```

## Architecture

This is a template app of a Firebase backend using Data Connect (PostgreSQL)

### Project Structure
- ./ - this project, firebase Data Connect schema, queries, and mutations
- ../dataconnect-generated/ — Auto-generated Swift connectors (read-only)
- ../{other projects} - client apps


## Schema

Key tables in `dataconnect/schema/schema.gql`:
- `UserAccount` — User profiles keyed by Firebase Auth UID
- `UserDisplayName` — Unique display names (separate table for uniqueness enforcement)
- `UserDemographicProfile` — Append-only demographics (latest row = current)
- `UserAssociation` — Follow/block relationships between users
- `PublicComment` / `PrivateMessage` — User-generated content with reference and status tracking


## Do Not Modify
- `../dataconnect-generated/` — Regenerated by `firebase dataconnect:sdk:generate`
- To change Data Connect behavior, modify `schema.gql`, `queries.gql`, or `mutations.gql` — not the generated connectors


## Testing
- Manual testing only (no automated test suite)


## Workflow
1. Claude: modify schema, queries, or mutations in `dataconnect/`
2. Claude: run `firebase dataconnect:sdk:generate` to check for errors
3. Claude: fix errors and repeat
4. Human:  reviews changes and deploys with CLI
5. Git Workflow: Feature branches from `develop`, squash-merge to `develop`, then squash to `main` for releases


## Common Issues
- **Schema migration conflicts**: Check deployed mutations before removing tables
- **Firebase auth required**: Run `firebase login` if commands fail with auth errors
- **Generated code errors**: Never edit files in `dataconnect-generated/`; fix the source schema/queries instead
